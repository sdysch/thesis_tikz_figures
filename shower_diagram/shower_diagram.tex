\begin{tikzpicture}

	% diagrams

	% small gluons
	\tikzset{
		smallGluon/.style={decorate, draw=black,
		decoration={coil,aspect=0.3,segment length=3pt,amplitude=2pt}}
	 }

	% very small ellipse used for parton to hadron transistions
	\def\verySmallEllipseRx{0.5 * \smallEllipseRx}
	\def\verySmallEllipseRy{0.5 * \smallEllipseRy}
	\def\manualRotationOffset{225}

	% hadronisation diagram
	\tikzset{
		hadronisation/.code args = {#1, #2, #3}{%
			\foreach \i in {-0.1, 0.1} \draw[rotate around = {#3 + \manualRotationOffset:(#1, #2)}, color = green] (#1, #2) -- (#1 + 0.5 + \i , #2 - 0.5 + \i);
			\draw[dashed, rotate around = {#3 + \manualRotationOffset:(#1, #2)}, color = green] (#1, #2) -- (#1 + 0.5 , #2 - 0.5);
			\draw[color = black, rotate around = {#3 + \manualRotationOffset:(#1, #2)}, fill = green] (#1 + 0.5 , #2 - 0.5) circle (0.075);
			\draw[dashed, rotate around = {#3 + \manualRotationOffset:(#1, #2)}, color = green] (#1, #2) -- (#1 + 0.3 , #2 - 0.7);
			\draw[color = black, rotate around = {#3 + \manualRotationOffset:(#1, #2)}, fill = green] (#1 + 0.3 , #2 - 0.7) circle (0.05);
			\draw[dashed, rotate around = {#3 + \manualRotationOffset:(#1, #2)}, color = green] (#1, #2) -- (#1 + 0.7 , #2 - 0.3);
			\draw[color = black, rotate around = {#3 + \manualRotationOffset:(#1, #2)}, fill = green] (#1 + 0.7 , #2 - 0.3) circle (0.05);
			\draw[color = black, fill = blue] (#1, #2) circle [x radius = \verySmallEllipseRx, y radius = \verySmallEllipseRy, rotate = #3];
		}
	}

	% hadronisation diagram with smaller decay
	\tikzset{
		hadronisationSmallDecay/.code args = {#1, #2, #3}{%
			\foreach \i in {-0.3, -0.1, 0.1, 0.3} \draw[rotate around = {#3 + \manualRotationOffset:(#1, #2)}, color = green] (#1, #2) -- (#1 + 0.25 + \i , #2 - 0.25 + \i);
			\foreach \i in {-0.2, 0, 0.2} \draw[rotate around = {#3 + \manualRotationOffset:(#1, #2)}, color = green, dashed] (#1, #2) -- (#1 + 0.25 + \i , #2 - 0.25 + \i);
			\draw[color = black, fill = blue] (#1, #2) circle [x radius = \verySmallEllipseRx, y radius = \verySmallEllipseRy, rotate = #3];
		}
	}

	% proton scatter diagram
	\tikzset{
		protonScatter/.code args = {#1, #2, #3}{%
			\draw[color = black, fill = cyan] (#1, #2) circle [x radius = 0.5 * \verySmallEllipseRx, y radius = #3];
		}
	}


	% coordinates
	\def\hardScatterRadius{0.3}
	\def\protonPosition{4}
	\def\UEPositionY{-1}
	\def\UEPositionX{0}
	\def\UEOffsetY{0.1}
	\def\UEHadXBase{5}
	\def\UEHadYBase{-4}
	\def\hardScatterX{0}
	\def\hardScatterY{1.5}

	% small ellipse
	\def\smallEllipseRx{0.1}
	\def\smallEllipseRy{4 * \smallEllipseRx}

	%\draw[color = black, thick, fill = green] (0, 1) circle [x radius = \smallEllipseRx, y radius = \smallEllipseRy];

	% arrows
	\tikzset{->-/.style={decoration={
		markings,
		mark=at position #1 with {\arrow{>}}},postaction={decorate}}}

	% valence quarks
	\def\valenceY{0.2}
	\draw[color = red, thick, ->-=0.5] (-2 * \protonPosition, -\valenceY) -- (-\protonPosition, -\valenceY);
	\draw[color = red, thick, ->-=0.5] (-2 * \protonPosition, 0) -- (-\protonPosition, 0);
	\draw[color = red, thick, ->-=0.5] (-2 * \protonPosition, \valenceY) -- (-\protonPosition, \valenceY);

	\draw[color = red, thick, ->-=0.5] (2 * \protonPosition, -\valenceY) -- (\protonPosition, -\valenceY);
	\draw[color = red, thick, ->-=0.5] (2 * \protonPosition, 0) -- (\protonPosition, 0);
	\draw[color = red, thick, ->-=0.5] (2 * \protonPosition, \valenceY) -- (\protonPosition, \valenceY);


	% partons from proton
	\draw[smallGluon, color = orange] (\protonPosition, -3 * \UEOffsetY) -- (\UEPositionX, \UEPositionY - 1 * \UEOffsetY);
	\draw[smallGluon, color = orange] (-\protonPosition, -3 * \UEOffsetY) -- (\UEPositionX, \UEPositionY - 1 * \UEOffsetY);
	\draw[smallGluon, color = orange] (\protonPosition, -1 * \UEOffsetY) -- (\UEPositionX, \UEPositionY + \UEOffsetY);
	\draw[thick, color = orange] (-\protonPosition, -1 * \UEOffsetY) -- (\UEPositionX, \UEPositionY + \UEOffsetY);

	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Underlying event
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	% underlying event hadronisation + hadronisation
	%FIXME, rotation angle done by eye, not actually calculated from geometry
	\draw[color = orange, thick] (\UEPositionX, \UEPositionY -2 * \UEOffsetY) -- (\UEHadXBase, \UEHadYBase);
	\draw[hadronisation = {\UEHadXBase, \UEHadYBase, 150}];

	\draw[smallGluon, color = orange, thick] (-\UEPositionX, \UEPositionY -2 * \UEOffsetY) -- (-\UEHadXBase, \UEHadYBase);
	\draw[hadronisation = {-\UEHadXBase, \UEHadYBase, 30}];

	\draw[smallGluon, color = orange, thick] (\UEPositionX, \UEPositionY -2 * \UEOffsetY) -- (0.8 * \UEHadXBase, 1.2 * \UEHadYBase);
	\draw[hadronisation = {0.8 * \UEHadXBase, 1.2 * \UEHadYBase, 140}];

	\draw[color = orange, thick] (-\UEPositionX, \UEPositionY -2 * \UEOffsetY) -- (-0.8 * \UEHadXBase, 1.2 * \UEHadYBase);
	\draw[hadronisation = {-0.8 * \UEHadXBase, 1.2 * \UEHadYBase, 40}];

	\draw[color = orange, thick] (\UEPositionX, \UEPositionY) -- (\UEPositionX, 3 * \UEPositionY);
	\draw[color = orange, thick] (\UEPositionX, 3 * \UEPositionY) -- (\UEPositionX + 2, 5 * \UEPositionY);
	\draw[hadronisation = {\UEPositionX + 2, 5 * \UEPositionY, 130}];

	\draw[smallGluon, color = orange] (\UEPositionX, 3 * \UEPositionY) -- (\UEPositionX, 5 * \UEPositionY);
	\draw[hadronisation = {\UEPositionX, 5 * \UEPositionY, 90}];

	\draw[smallGluon, color = orange] (\UEPositionX, 3.5 * \UEPositionY) -- (\UEPositionX - 2, 5 * \UEPositionY);
	\draw[hadronisation = {\UEPositionX - 2, 5 * \UEPositionY, 50}];


	% UE ellipse
	\draw[color = black, thick, fill = orange] (\UEPositionX, \UEPositionY) circle [x radius = \smallEllipseRx, y radius = \smallEllipseRy];

	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% Proton scatter 
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	\draw[color = blue, thick] (-\protonPosition, -0.075) -- (-\protonPosition + 1, -0.075);
	\draw[smallGluon, color = blue] (-\protonPosition, 0.075) -- (-\protonPosition + 1, 0.075);
	\draw[protonScatter = {-\protonPosition + 1, 0, 0.75 * \verySmallEllipseRy}];

	\draw[color = blue, thick] (\protonPosition, 0.075) -- (\protonPosition - 1, 0.075);
	\draw[protonScatter = {\protonPosition - 1, 0.075, 0.5 * \verySmallEllipseRy}];


	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	% hard scatter
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	% partons for hard scatter
	\def\quarkGluonVertexX{1.6}
	\def\quarkGluonVertexY{0.5}
	\def\gluonGluonVertexX{-1.6}
	\def\gluonGluonVertexY{0.5}

	\draw[color = blue, thick] (\protonPosition, 0.2) -- (\quarkGluonVertexX, \quarkGluonVertexY);
	\draw[color = blue, thick] (\quarkGluonVertexX, \quarkGluonVertexY) -- (0.5, \quarkGluonVertexY);
	\draw[smallGluon, color = blue] (\quarkGluonVertexX, \quarkGluonVertexY) -- (\hardScatterX + \hardScatterRadius, \hardScatterY);

	\draw[smallGluon, color = blue] (-\protonPosition, 0.2) -- (\gluonGluonVertexX, \gluonGluonVertexY);
	\draw[smallGluon, color = blue] (\gluonGluonVertexX, \gluonGluonVertexY) -- (-0.5, \gluonGluonVertexY);
	\draw[smallGluon, color = blue] (\gluonGluonVertexX, \gluonGluonVertexY) -- (\hardScatterX - \hardScatterRadius, \hardScatterY);

	% hadronisation
	\draw[hadronisationSmallDecay = {0.5, \quarkGluonVertexY, 0}];
	\draw[hadronisationSmallDecay = {-0.5, \gluonGluonVertexY, 180}];

	% blue circle for hard scatter
	\draw[color = black, thick, pattern = north west lines, pattern color = blue] (\hardScatterX, \hardScatterY) circle (\hardScatterRadius);


	% protons
	\draw[color = black, thick, fill = red] (-\protonPosition, 0) circle [x radius = \smallEllipseRx, y radius = \smallEllipseRy];
	\draw[color = black, thick, fill = red] (\protonPosition, 0) circle [x radius = \smallEllipseRx, y radius = \smallEllipseRy];


\end{tikzpicture}
